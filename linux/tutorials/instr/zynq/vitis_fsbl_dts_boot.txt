https://habr.com/ru/articles/565368/


new -> platform project
get xsa file set linux system
build -> get fsbl.elf


git clone https://github.com/Xilinx/device-tree-xlnx
cd device-tree-xlnx
git checkout xilinx-v2021.2
Xiinx-SoftwareRepos-> add device-tree-xlnx

Xilinx-GenerateDeviceTree -> get xsa with bitstream

# Makefile generated by Xilinx.
all:
	gcc -I my_dts -E -nostdinc -undef -D__DTS__ -x assembler-with-cpp -o system.dts system-top.dts
	dtc -I dts -O dtb -o ebaz.dtb system.dts

cp ebaz.dtb to uboot/arch/arm/dts

make uboot.elf (see uboot_instr.txt)

# Create boot.bin

Xiinx-CreateBootImage->

add fsbl.elf
add bitstream
add uboot.elf


////////////  Device tree for eth emio need to add emio_clck   /////////////////
add pcw.dtsi:
&clkc {
	fclk-enable = <0x1>;
	ps-clk-frequency = <33333333>;
	clocks = <&ephy0_clk>;
	clock-names = "gem0_emio_clk";
};
&gem0 {
	status = "okay";
	phy-mode = "rgmii-id";
	phy-handle = <&ethernet_phy>;
	local-mac-address = [44 8F 17 36 1B A0];

	ethernet_phy: ethernet-phy@0 {
		reg = <0>;
		max-speed = <100>;
	};
};

system-top.dts
/dts-v1/;
#include "zynq-7000.dtsi"
#include "pl.dtsi"
#include "pcw.dtsi"
/ {
	chosen {
		bootargs = "earlycon";
		stdout-path = "serial0:115200n8";
	};
	aliases {
		ethernet0 = &gem0;
		serial0 = &uart1;
		spi0 = &spi0;
	};
	memory {
		device_type = "memory";
		reg = <0x0 0x10000000>;
	};
	ephy0_clk: ephy0-clk {
		#clock-cells = <0>;
		compatible = "fixed-clock";
		clock-frequency = <25000000>;
		clock-output-names = "ephy0_clk";
	};
};
